# Jenkins ConfigMap - 配置文件
# 仅包含 JVM 和 Jenkins 启动参数，其他配置通过界面完成

apiVersion: v1
kind: ConfigMap
metadata:
  name: jenkins-config
  namespace: jenkins
  labels:
    app.kubernetes.io/name: jenkins
    app.kubernetes.io/component: config
data:
  # JVM 参数配置
  # 注意：已移除 JCasC 相关参数，启用安装向导
  JAVA_OPTS: >-
    -Xmx2048m 
    -Xms1024m 
    -XX:+UseG1GC 
    -XX:+UseStringDeduplication 
    -XX:+ParallelRefProcEnabled 
    -XX:+DisableExplicitGC 
    -Duser.timezone=Asia/Shanghai 
    -Djava.awt.headless=true 
    -Dhudson.slaves.NodeProvisioner.initialDelay=0 
    -Dhudson.slaves.NodeProvisioner.MARGIN=50 
    -Dhudson.slaves.NodeProvisioner.MARGIN0=0.85

  # Jenkins 启动参数
  JENKINS_OPTS: >-
    --httpPort=8080

  # 插件安装列表（初始化容器使用）
  plugins.txt: |
    kubernetes:latest
    workflow-aggregator:latest
    git:latest
    github:latest
    github-branch-source:latest
    credentials-binding:latest
    timestamper:latest
    ws-cleanup:latest
    pipeline-stage-view:latest
    blueocean:latest
    docker-workflow:latest
    matrix-auth:latest
    antisamy-markup-formatter:latest
    build-timeout:latest
    email-ext:latest
    mailer:latest
    ssh-agent:latest
    pipeline-github-lib:latest
    pipeline-utility-steps:latest
    job-dsl:latest
    locale:latest

